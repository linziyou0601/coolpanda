{% extends "base.html" %}
{% block title %}牛批熊貓 - 推播訊息{% endblock %}
{% block navPush %}active{% endblock %}
{% block content %}

<div id="newPushMsg" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">推播訊息</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="post" class="col-12">
            <!-- 防止csrf攻擊 -->
            {% csrf_token %}
            <div class="form-group">
                <label for="{{ form.messageTitle.id_for_label }}">訊息標題</label>
                <input type="text" name="{{ form.messageTitle.html_name }}" class="form-control" id="{{ form.messageTitle.id_for_label }}" required>
            </div>
            <div class="form-group">
                <label for="{{ form.messageType.id_for_label }}">訊息類型</label>
                <select class="form-control" id="{{ form.messageType.id_for_label }}">
                  <option value="text" selected>文字</option>
                  <option value="flex">Flex</option>
                  <option value="image">圖片</option>
                </select>
            </div>
            <div class="form-group">
                <label for="{{ form.messageContent.id_for_label }}">內容</label>
                <textarea rows="5" name="{{ form.messageContent.html_name }}" class="form-control" id="{{ form.messageContent.id_for_label }}" placeholder="文字訊息請直接輸入&#10;Flex訊息請輸入JSON格式文字&#10;圖片訊息請貼上'https://'網址" required></textarea>
            </div>

            <input type="submit" class="btn btn-info my-2 mx-2" value="發送" />
            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
        </form>
      </div>
    </div>
  </div>
</div>


<div class="jumbotron">
    <div class="container">
        <h1 class="display-3 mt-3">推播訊息</h1>
        <p class="text-danger">{{ validStr }}</p>
        <p><a class="btn btn-primary btn-lg" href="JavaScript:Void(0)" role="button" onclick="$('#newPushMsg').modal('show')">新增訊息 &raquo;</a></p>
    </div>
</div>

<div class="container">
    <h2>近5筆推播訊息</h2>
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">類型</th>
                <th scope="col">標題</th>
                <th scope="col">內容</th>
                <th scope="col">建立時間</th>
            </tr>
        </thead>
        {% for item in allPushes %}
            <tr>
                <td scope="row">{{ item.id }}</td>
                <td>{{ item.message_type }}</td>
                <td>{{ item.message_title }}</td>
                <td>{{ item.message_content }}</td>
                <td>{{ item.create_at }}</td>
            </tr>
        {% endfor %}
    </table>
    <hr>
</div> <!-- /container -->
{% endblock %}